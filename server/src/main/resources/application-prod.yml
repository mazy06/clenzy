server:
  port: 8080

spring:
  datasource:
    url: ${SPRING_DATASOURCE_URL}
    username: ${SPRING_DATASOURCE_USERNAME}
    password: ${SPRING_DATASOURCE_PASSWORD}
  jpa:
    hibernate:
      ddl-auto: validate
    open-in-view: false
    properties:
      hibernate:
        jdbc:
          time_zone: Europe/Paris
  jackson:
    time-zone: Europe/Paris
  mail:
    host: ${MAIL_HOST:smtp-relay.brevo.com}
    port: ${MAIL_PORT:587}
    username: ${MAIL_USERNAME:${BREVO_SMTP_USERNAME:}}
    password: ${MAIL_PASSWORD:${BREVO_SMTP_KEY:}}
    properties:
      mail:
        smtp:
          auth: true
          connectiontimeout: ${MAIL_SMTP_CONNECTION_TIMEOUT_MS:5000}
          timeout: ${MAIL_SMTP_TIMEOUT_MS:5000}
          writetimeout: ${MAIL_SMTP_WRITE_TIMEOUT_MS:5000}
          pool: true
          poolSize: ${MAIL_SMTP_POOL_SIZE:50}
          quitwait: false
          ssl:
            enable: false
          starttls:
            enable: true
            required: true
  security:
    oauth2:
      resourceserver:
        jwt:
          jwk-set-uri: ${SPRING_SECURITY_OAUTH2_RESOURCESERVER_JWT_JWK_SET_URI}

keycloak:
  auth-server-url: ${KEYCLOAK_AUTH_SERVER_URL}
  realm: ${KEYCLOAK_REALM:clenzy}
  resource: ${KEYCLOAK_RESOURCE:clenzy-web}
  credentials:
    secret: ${KEYCLOAK_CLIENT_SECRET}

# Kafka
  kafka:
    bootstrap-servers: ${SPRING_KAFKA_BOOTSTRAP_SERVERS:clenzy-kafka:9092}
    consumer:
      group-id: clenzy-backend
      auto-offset-reset: earliest
    producer:
      acks: all

# Airbnb Integration
airbnb:
  api:
    base-url: https://api.airbnb.com/v2
  oauth:
    client-id: ${AIRBNB_CLIENT_ID:}
    client-secret: ${AIRBNB_CLIENT_SECRET:}
    redirect-uri: ${AIRBNB_REDIRECT_URI:}
    authorization-url: https://www.airbnb.com/oauth2/auth
    token-url: https://api.airbnb.com/v2/oauth2/authorizations
    scopes: listings_r,reservations_r,reservations_w,calendar_r,calendar_w,messages_r,messages_w
  webhook:
    secret: ${AIRBNB_WEBHOOK_SECRET:}
  sync:
    enabled: true
    interval-minutes: 15

# Jasypt (chiffrement des tokens en base)
jasypt:
  encryptor:
    password: ${JASYPT_ENCRYPTOR_PASSWORD}

# Swagger desactive en production
springdoc:
  api-docs:
    enabled: false
  swagger-ui:
    enabled: false

cors:
  allowed-origins: ${ALLOWED_ORIGINS}

# Stripe
stripe:
  secret-key: ${STRIPE_SECRET_KEY}
  publishable-key: ${STRIPE_PUBLISHABLE_KEY}
  webhook-secret: ${STRIPE_WEBHOOK_SECRET}
  currency: eur

# Monitoring
management:
  endpoints:
    web:
      exposure:
        include: health,info,metrics,prometheus
  endpoint:
    health:
      show-details: WHEN_AUTHORIZED
    metrics:
      enabled: true
  metrics:
    export:
      prometheus:
        enabled: true

# Logging
logging:
  level:
    org.hibernate.SQL: warn
    org.springframework.web: warn
    com.clenzy: info
    org.springframework.security: warn

clenzy:
  mail:
    provider: ${MAIL_PROVIDER:brevo}
    from: ${MAIL_FROM:info@clenzy.fr}
    notification-to: ${MAIL_NOTIFICATION_TO:info@clenzy.fr}
    contact:
      max-attachments: ${MAIL_MAX_ATTACHMENTS:10}
      max-attachment-size-bytes: ${MAIL_MAX_ATTACHMENT_SIZE_BYTES:10485760}
  imap:
    enabled: ${IMAP_ENABLED:false}
    host: ${IMAP_HOST:mail.clenzy.fr}
    port: ${IMAP_PORT:993}
    username: ${IMAP_USERNAME:info@clenzy.fr}
    password: ${IMAP_PASSWORD:}
  uploads:
    contact-dir: ${CONTACT_UPLOADS_DIR:/app/uploads/contact}
    templates-dir: ${TEMPLATES_DIR:/app/uploads/templates}
    documents-dir: ${DOCUMENTS_DIR:/app/uploads/documents}
  libreoffice:
    url: ${LIBREOFFICE_URL:http://clenzy-libreoffice:3000}
